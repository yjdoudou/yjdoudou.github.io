<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>写博客的初衷</title>
    <url>/2020/07/29/16035/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><p>从工作到现在，码了很多代码了，有简单的，有麻烦的，很多的东西当时实现了，经过一段时间，后面又遇到同样的场景，没办法，又得重来一遍，使用很多开源的组件，每次都去网上找别人的博客，质量参差不齐，所以新建一个博客以记录平时开发过程中遇到的一些场景、问题。方便后续查找，基本是属于自己的一个笔记吧！哈哈！</p><p>=================================================&gt;2020.8.12</p><p>网上有那么多写的比我详细，比我完整的，为什么我还要写呢？找起来麻烦吧！先看自己的，再查别人的，哈哈！</p><p>============================================20208.17</p><p>常见软件安装破解教程亲身测验在百度网盘<code>/私人/软件破解</code>下。</p><!-- rebuild by neat -->]]></content>
  </entry>
  <entry>
    <title>渗透-扫描端口</title>
    <url>/2020/08/26/64800/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><h1 id="扫描端口"><a href="#扫描端口" class="headerlink" title="扫描端口"></a>扫描端口</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nmap -sT 103.147.13.182</span><br></pre></td></tr></table></figure><p>或者一段简单的代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AA</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">65535</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">65535</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> finalI = i;</span><br><span class="line">            Callable&lt;Integer&gt; task = () -&gt; &#123;</span><br><span class="line">                <span class="keyword">boolean</span> hostConnectable = isHostConnectable(<span class="string">"103.147.13.182"</span>, finalI);</span><br><span class="line">                <span class="keyword">if</span> (hostConnectable)&#123;</span><br><span class="line">                    System.out.println(finalI);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> finalI;</span><br><span class="line">            &#125;;</span><br><span class="line">            Future&lt;Integer&gt; future = executorService.submit(task);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Integer s = future.get(<span class="number">1</span>, TimeUnit.MICROSECONDS);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception ignored) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"======================"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isHostConnectable</span><span class="params">(String host, <span class="keyword">int</span> port)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Socket socket = <span class="keyword">new</span> Socket();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            socket.connect(<span class="keyword">new</span> InetSocketAddress(host, port));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                socket.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ignored) &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="扫描随机可用redis"><a href="#扫描随机可用redis" class="headerlink" title="扫描随机可用redis"></a>扫描随机可用redis</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># 添加maven依赖</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">   &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line">   &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"># 简单代码</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BB</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ExecutorService executorService = Executors.newFixedThreadPool(<span class="number">100000</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">            executorService.execute(() -&gt; connectRedis(getRandomIp()));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"======================"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">connectRedis</span><span class="params">(String ip)</span></span>&#123;</span><br><span class="line">        Jedis jedis=<span class="keyword">new</span> Jedis(ip,<span class="number">6379</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String pong = jedis.ping();</span><br><span class="line">            System.out.println(ip);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">"NOAUTH Authentication required."</span>.equals(e.getMessage()))&#123;</span><br><span class="line">                System.out.println(ip+<span class="string">"============没有密码"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 随机生成国内IP地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getRandomIp</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ip范围</span></span><br><span class="line">        <span class="keyword">int</span>[][] range = &#123; &#123; <span class="number">607649792</span>, <span class="number">608174079</span> &#125;,<span class="comment">// 36.56.0.0-36.63.255.255</span></span><br><span class="line">                &#123; <span class="number">1038614528</span>, <span class="number">1039007743</span> &#125;,<span class="comment">// 61.232.0.0-61.237.255.255</span></span><br><span class="line">                &#123; <span class="number">1783627776</span>, <span class="number">1784676351</span> &#125;,<span class="comment">// 106.80.0.0-106.95.255.255</span></span><br><span class="line">                &#123; <span class="number">2035023872</span>, <span class="number">2035154943</span> &#125;,<span class="comment">// 121.76.0.0-121.77.255.255</span></span><br><span class="line">                &#123; <span class="number">2078801920</span>, <span class="number">2079064063</span> &#125;,<span class="comment">// 123.232.0.0-123.235.255.255</span></span><br><span class="line">                &#123; -<span class="number">1950089216</span>, -<span class="number">1948778497</span> &#125;,<span class="comment">// 139.196.0.0-139.215.255.255</span></span><br><span class="line">                &#123; -<span class="number">1425539072</span>, -<span class="number">1425014785</span> &#125;,<span class="comment">// 171.8.0.0-171.15.255.255</span></span><br><span class="line">                &#123; -<span class="number">1236271104</span>, -<span class="number">1235419137</span> &#125;,<span class="comment">// 182.80.0.0-182.92.255.255</span></span><br><span class="line">                &#123; -<span class="number">770113536</span>, -<span class="number">768606209</span> &#125;,<span class="comment">// 210.25.0.0-210.47.255.255</span></span><br><span class="line">                &#123; -<span class="number">569376768</span>, -<span class="number">564133889</span> &#125;, <span class="comment">// 222.16.0.0-222.95.255.255</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Random rdint = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">int</span> index = rdint.nextInt(<span class="number">10</span>);</span><br><span class="line">        String ip = num2ip(range[index][<span class="number">0</span>] + <span class="keyword">new</span> Random().nextInt(range[index][<span class="number">1</span>] - range[index][<span class="number">0</span>]));</span><br><span class="line">        <span class="keyword">return</span> ip;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 将十进制转换成ip地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">num2ip</span><span class="params">(<span class="keyword">int</span> ip)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] b = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">4</span>];</span><br><span class="line">        String x = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">        b[<span class="number">0</span>] = (<span class="keyword">int</span>) ((ip &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">        b[<span class="number">1</span>] = (<span class="keyword">int</span>) ((ip &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">        b[<span class="number">2</span>] = (<span class="keyword">int</span>) ((ip &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">        b[<span class="number">3</span>] = (<span class="keyword">int</span>) (ip &amp; <span class="number">0xff</span>);</span><br><span class="line">        x = Integer.toString(b[<span class="number">0</span>]) + <span class="string">"."</span> + Integer.toString(b[<span class="number">1</span>]) + <span class="string">"."</span> + Integer.toString(b[<span class="number">2</span>]) + <span class="string">"."</span> + Integer.toString(b[<span class="number">3</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="安装kali"><a href="#安装kali" class="headerlink" title="安装kali"></a>安装kali</h1><p>Kali是安全从业人员常用的Linux系统，自带有大量安全工具集。</p><p>从阿里云开源镜像站下载<a href="https://mirrors.aliyun.com/kali-images/" target="_blank" rel="noopener">https://mirrors.aliyun.com/kali-images/</a></p><h1 id="通过redis渗透服务器"><a href="#通过redis渗透服务器" class="headerlink" title="通过redis渗透服务器"></a>通过redis渗透服务器</h1><p>目前很多redis都没有设置密码，我们通过ip端口就可以直接连接redis。</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>渗透</category>
      </categories>
      <tags>
        <tag>渗透</tag>
      </tags>
  </entry>
  <entry>
    <title>RabbitMQ的基本使用</title>
    <url>/2020/08/18/19840/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><p>之前用过activeMQ，zeroMQ，但是都是公司要用，并非自己选型，且从来没有考虑过消息幂等性问题，决定使用MQ就要承担使用MQ后的带来的系统复杂程度提高。看过好几个MQ对比，决定看看RabbitMQ和RocketMQ，今天先快速了解一下RabbitMQ。</p><h1 id="RabbitMQ快速入门"><a href="#RabbitMQ快速入门" class="headerlink" title="RabbitMQ快速入门"></a>RabbitMQ快速入门</h1><h2 id="安装RabbitMQ"><a href="#安装RabbitMQ" class="headerlink" title="安装RabbitMQ"></a>安装RabbitMQ</h2><p>拉取RabbitMQ带web界面的镜像。<code>docker pull rabbitmq:management</code></p><p>启动容器</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d --restart=always --name rabbitmq -p 5672:5672 -p 6006:15672 -v /usr/project/docker/rabbitmq/data:/var/lib/rabbitmq rabbitmq:management</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>消息队列</tag>
      </tags>
  </entry>
  <entry>
    <title>Mybatis的基础使用</title>
    <url>/2020/08/11/59904/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><p>mybatis是目前比较主流的ORM框架，今天对mybatis的一些基础用法做一总结记录。</p><h1 id="常见入参方式"><a href="#常见入参方式" class="headerlink" title="常见入参方式"></a>常见入参方式</h1><h1 id="resultMap的使用"><a href="#resultMap的使用" class="headerlink" title="resultMap的使用"></a>resultMap的使用</h1><h2 id="简单解释"><a href="#简单解释" class="headerlink" title="简单解释"></a>简单解释</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--下面的是抄来的--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--column不做限制，可以为任意表的字段，而property须为type 定义的pojo属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"唯一的标识"</span> <span class="attr">type</span>=<span class="string">"映射的pojo对象"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"表的主键字段，或者可以为查询语句中的别名字段"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"映射pojo对象的主键属性"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"表的一个字段（可以为任意表的一个字段）"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"映射到pojo对象的一个属性（须为type定义的pojo对象中的一个属性）"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"pojo的一个对象属性"</span> <span class="attr">javaType</span>=<span class="string">"pojo关联的pojo对象"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"关联pojo对象对应表的主键字段"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"关联pojo对象的主席属性"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span>  <span class="attr">column</span>=<span class="string">"任意表的字段"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"关联pojo对象的属性"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 集合中的property须为oftype定义的pojo对象的属性--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"pojo的集合属性"</span> <span class="attr">ofType</span>=<span class="string">"集合中的pojo对象"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"集合中pojo对象对应的表的主键字段"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"集合中pojo对象的主键属性"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"可以为任意表的字段"</span> <span class="attr">jdbcType</span>=<span class="string">"字段类型"</span> <span class="attr">property</span>=<span class="string">"集合中的pojo对象的属性"</span> /&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.xqh.railway.railwaybureau.domain.Project"</span> <span class="attr">id</span>=<span class="string">"projectMap"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"ID"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"lineId"</span> <span class="attr">column</span>=<span class="string">"LINE_ID"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"NAME"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"type"</span> <span class="attr">column</span>=<span class="string">"TYPE"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"projectType"</span> <span class="attr">column</span>=<span class="string">"PROJECT_TYPE"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"status"</span> <span class="attr">column</span>=<span class="string">"STATUS"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"startLength"</span> <span class="attr">column</span>=<span class="string">"START_LENGTH"</span> <span class="attr">jdbcType</span>=<span class="string">"NUMERIC"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"endLength"</span> <span class="attr">column</span>=<span class="string">"END_LENGTH"</span> <span class="attr">jdbcType</span>=<span class="string">"NUMERIC"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"createTime"</span> <span class="attr">column</span>=<span class="string">"CREATE_TIME"</span> <span class="attr">jdbcType</span>=<span class="string">"TIMESTAMP"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"modifyTime"</span> <span class="attr">column</span>=<span class="string">"MODIFY_TIME"</span> <span class="attr">jdbcType</span>=<span class="string">"TIMESTAMP"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"endTime"</span> <span class="attr">column</span>=<span class="string">"END_TIME"</span> <span class="attr">jdbcType</span>=<span class="string">"TIMESTAMP"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"plan"</span> <span class="attr">column</span>=<span class="string">"PLAN"</span> <span class="attr">jdbcType</span>=<span class="string">"NUMERIC"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"complete"</span> <span class="attr">column</span>=<span class="string">"COMPLETE"</span> <span class="attr">jdbcType</span>=<span class="string">"NUMERIC"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"planDay"</span> <span class="attr">column</span>=<span class="string">"PLAN_DAY"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"useDay"</span> <span class="attr">column</span>=<span class="string">"USE_DAY"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"line"</span> <span class="attr">javaType</span>=<span class="string">"com.xqh.railway.railwaybureau.domain.Line"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"LID"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span>  <span class="attr">column</span>=<span class="string">"LNAME"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"testUnitList"</span> <span class="attr">ofType</span>=<span class="string">"com.xqh.railway.system.domain.Unit"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"UNIT_ID"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> <span class="attr">property</span>=<span class="string">"unitId"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"UNIT_NAME"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> <span class="attr">property</span>=<span class="string">"unitName"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="mybatis中-lt-CDATA-gt-的作用"><a href="#mybatis中-lt-CDATA-gt-的作用" class="headerlink" title="mybatis中&lt;![CDATA[]]&gt;的作用"></a>mybatis中<code>&lt;![CDATA[]]&gt;</code>的作用</h1><p>在使用mybatis 时我们sql是写在xml 映射文件中，如果写的sql中有一些特殊的字符的话，在解析xml文件的时候会被转义，但我们不希望他被转义，所以我们要使用来解决。</p><p>被<code>&lt;![CDATA[]]&gt;</code>这个标记所包含的内容将表示为<strong>纯文本</strong>，比如<code>&lt;![CDATA[&lt;]]&gt;</code>表示文本内容<code>“&lt;”</code>。<br>此标记用于xml文档中，我们先来看看使用转义符的情况。我们知道，在xml中，<code>”&lt;”</code>、<code>”&gt;”</code>、<code>”&amp;”</code>等字符是不能直接存入的，否则xml语法检查时会<strong>报错</strong>，如果想在xml中使用这些符号，必须将其转义为实体，如<code>”&amp;lt;”</code>、<code>”&amp;gt;”</code>、<code>”&amp;amp;”</code>，这样才能保存进xml文档。</p><p>在XML中，需要转义的字符有：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">在XML中，需要转义的字符有：</span><br><span class="line">&amp;　　　&amp;</span><br><span class="line">&lt;　　　&lt;</span><br><span class="line">&gt;　　　&gt;</span><br><span class="line">＂　　　&quot;</span><br><span class="line">＇　　　&amp;apos;</span><br></pre></td></tr></table></figure><p><code>&lt;![CDATA[]]&gt;</code>和xml转移字符的关系，它们两个看起来是不是感觉功能重复了？<br>　　是的，它们的功能就是一样的，只是应用场景和需求有些不同：<br>　　(1)<code>&lt;![CDATA[]]&gt;</code>不能适用所有情况，转义字符可以；<br>　　(2) 对于短字符串<code>&lt;![CDATA[]]&gt;</code>写起来啰嗦，对于长字符串转义字符写起来可读性差；<br>　　(3) <code>&lt;![CDATA[]]&gt;</code>表示xml解析器忽略解析，所以更快。</p><p>注意：</p><ol><li>此部分不能再包含<code>”]]&gt;”</code>；</li><li>不允许嵌套使用；</li><li><code>”]]&gt;”</code>这部分不能包含空格或者换行。</li><li>mybatis中的<code>&lt;if test=&quot;&quot;&gt;&lt;/if&gt;、&lt;where&gt;&lt;/where&gt;、&lt;choose&gt;&lt;/choose&gt;、&lt;trim&gt;&lt;/trim&gt;</code> 等这些标签不能写到CDATA中。否则标签将不会被mybatis解析。</li></ol><!-- rebuild by neat -->]]></content>
      <categories>
        <category>mybatis</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>docker安装frp内网穿透</title>
    <url>/2020/08/05/57486/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><h1 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h1><h2 id="创建frp配置文件"><a href="#创建frp配置文件" class="headerlink" title="创建frp配置文件"></a>创建frp配置文件</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建frp文件夹</span></span><br><span class="line">mkdir -p frp &amp;&amp; cd frp</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建frps.ini</span></span><br><span class="line">cat &lt;&lt;EOF&gt; frps.ini</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制如下配置，自行修改密码</span></span><br><span class="line">[common]</span><br><span class="line">bind_port = 10000</span><br><span class="line">vhost_http_port = 10001</span><br><span class="line">vhost_https_port = 10002</span><br><span class="line">dashboard_addr = 0.0.0.0</span><br><span class="line">dashboard_port = 10003</span><br><span class="line">dashboard_user = zyj</span><br><span class="line">dashboard_pwd = xxx</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="启动docker容器"><a href="#启动docker容器" class="headerlink" title="启动docker容器"></a>启动docker容器</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建启动脚本</span></span><br><span class="line">cat &lt;&lt;EOF&gt; start.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制如下配置，挂载容器的frps.ini目录请自行修改</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">docker run -d \\</span><br><span class="line">    --restart always \\</span><br><span class="line">    --network host \\</span><br><span class="line">    --name frps \\</span><br><span class="line">    -v /usr/local/project/frp/frps.ini:/etc/frp/frps.ini \\</span><br><span class="line">    snowdreamtech/frps</span><br><span class="line">EOF</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行脚本</span></span><br><span class="line">sh start.sh</span><br></pre></td></tr></table></figure><p>访问<code>公网ip:10003</code>，输入账号密码，看到frp管理界面。</p><h1 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h1><h2 id="win10"><a href="#win10" class="headerlink" title="win10"></a>win10</h2><p>下载客户端<a href="https://github.com/fatedier/frp/releases/download/v0.30.0/frp_0.30.0_windows_amd64.zip" target="_blank" rel="noopener">https://github.com/fatedier/frp/releases/download/v0.30.0/frp_0.30.0_windows_amd64.zip</a></p><p>解压，修改<code>frpc.ini</code>文件</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 公网ip</span></span><br><span class="line">server_addr = 255.255.255.255</span><br><span class="line">server_port = 10000</span><br><span class="line"></span><br><span class="line">[portal]</span><br><span class="line">type = http</span><br><span class="line"><span class="meta">#</span><span class="bash"> 本地服务端口</span></span><br><span class="line">local_port = 8081</span><br><span class="line"><span class="meta">#</span><span class="bash"> 公网ip或者域名</span></span><br><span class="line">custom_domains = 255.255.255.255</span><br></pre></td></tr></table></figure><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><ol><li>创建frp配置文件,remote_port记得在公网放开防火墙</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建frp文件夹</span></span><br><span class="line">mkdir -p frp &amp;&amp; cd frp</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建frps.ini</span></span><br><span class="line">cat &lt;&lt;EOF&gt; frps.ini</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制如下配置</span></span><br><span class="line">[common]</span><br><span class="line">server_addr = 公网ip</span><br><span class="line">server_port = 10000</span><br><span class="line"></span><br><span class="line">[ssh]</span><br><span class="line">type = tcp</span><br><span class="line">local_ip = 127.0.0.1</span><br><span class="line">local_port = 22</span><br><span class="line">remote_port = 6000</span><br><span class="line"></span><br><span class="line">[nginx]</span><br><span class="line">type = tcp</span><br><span class="line">local_ip = 127.0.0.1</span><br><span class="line">local_port = 80</span><br><span class="line">remote_port = 6001</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><ol start="2"><li>启动docker容器</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建启动脚本</span></span><br><span class="line">cat &lt;&lt;EOF&gt; start.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 复制如下配置，挂载容器的frps.ini目录请自行修改</span></span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">docker run -d \\</span><br><span class="line">    --restart always \\</span><br><span class="line">    --network host \\</span><br><span class="line">    --name frpc \\</span><br><span class="line">    -v /usr/project/frp/frpc.ini:/etc/frp/frpc.ini \\</span><br><span class="line">    snowdreamtech/frpc</span><br><span class="line">EOF</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行脚本</span></span><br><span class="line">sh start.sh</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
      <categories>
        <category>部署</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>内网穿透</tag>
      </tags>
  </entry>
  <entry>
    <title>centos7安装jdk、docker</title>
    <url>/2020/07/29/13516/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><h1 id="安装JDk"><a href="#安装JDk" class="headerlink" title="安装JDk"></a>安装JDk</h1><ol><li><p>oracle官网下载JDk：jdk-8u261-linux-x64.rpm</p></li><li><p>安装JDK8：</p></li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rpm -ivh jdk-8u261-linux-x64.rpm</span><br></pre></td></tr></table></figure><ol><li>配置环境变量</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><ol start="3"><li>输入以下内容：</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">JAVA_HOME=/usr/java/jdk1.8.0_261-amd64</span><br><span class="line">JRE_HOME=/usr/java/jdk1.8.0_261-amd64/jre</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class="line">CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">export JAVA_HOME JRE_HOME PATH CLASSPATH</span><br></pre></td></tr></table></figure><a id="more"></a><p>然后执行以下命令生效：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h1 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载mysql</span></span><br><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar -zxvf mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建data文件夹</span></span><br><span class="line">mkdir data</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 在/etc目录下创建my.cnf文件</span></span><br><span class="line">vim /etc/my.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将以下内容写入</span></span><br><span class="line">[mysqld]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置3306端口</span></span><br><span class="line">port=3306</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置mysql的安装目录</span></span><br><span class="line">basedir=/usr/project/mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置mysql数据库的数据的存放目录</span></span><br><span class="line">datadir=/usr/project/mysql/data</span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许最大连接数/</span></span><br><span class="line">max_connections=10000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统</span></span><br><span class="line">max_connect_errors=10</span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务端使用的字符集默认为UTF8</span></span><br><span class="line"><span class="meta">#</span><span class="bash">character-set-server=UTF8</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建新表时将使用的默认存储引擎</span></span><br><span class="line">default-storage-engine=INNODB</span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认使用“mysql_native_password”插件认证</span></span><br><span class="line">default_authentication_plugin=mysql_native_password</span><br><span class="line">[mysql]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置mysql客户端默认字符集</span></span><br><span class="line">default-character-set=utf8</span><br><span class="line">[client]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置mysql客户端连接服务端时默认使用的端口</span></span><br><span class="line">port=3306</span><br><span class="line">default-character-set=utf8</span><br><span class="line">user=mysql</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 用户组</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户 （用户名/密码）</span></span><br><span class="line">useradd -g mysql mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 授权</span></span><br><span class="line">chown -R mysql.mysql /usr/project/mysql/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换mysql账户</span></span><br><span class="line">su mysql</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化mysql，注意保存root账户的密码</span></span><br><span class="line">./bin/mysqld --initialize</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动mysql</span></span><br><span class="line">cd support-files/</span><br><span class="line">./mysql.server start</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出mysql账户，登录mysql</span></span><br><span class="line">./bin/mysql -uroot -p</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改mysql密码</span></span><br><span class="line">alter user 'root'@'localhost' identified by 'xxxxxx';</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改root账户远程登录（谨慎操作）</span></span><br><span class="line">update user set host='%' where user='root' and host='localhost';</span><br><span class="line"><span class="meta">#</span><span class="bash"> 刷新</span></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将mysql加入到服务中</span></span><br><span class="line">cp /usr/project/mysql/support-files/mysql.server /etc/init.d/mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加开机启动</span></span><br><span class="line">chkconfig mysql on</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭mysql</span></span><br><span class="line">systemctl stop mysql</span><br></pre></td></tr></table></figure><h1 id="安装tomcat"><a href="#安装tomcat" class="headerlink" title="安装tomcat"></a>安装tomcat</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载tomcat，或者https://tomcat.apache.org/download-90.cgi官网下载</span></span><br><span class="line"></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-9/v9.0.37/bin/apache-tomcat-9.0.37.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar -zxv -f apache-tomcat-9.0.37.tar.gz</span><br></pre></td></tr></table></figure><h1 id="安装maven"><a href="#安装maven" class="headerlink" title="安装maven"></a>安装maven</h1><h1 id="安装Jenkins"><a href="#安装Jenkins" class="headerlink" title="安装Jenkins"></a>安装Jenkins</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载Jenkins，清华大学开源软件镜像站</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/jenkins/war/latest/jenkins.war</span><br></pre></td></tr></table></figure><p>编写启动脚本</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim run.sh</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">nohup java -jar jenkins.war --httpPort=6004</span><br></pre></td></tr></table></figure><p>或者放到tomcat中，修改tomcat</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">#添加Context标签，访问端口直接指向jenkins</span><br><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">docBase</span>=<span class="string">"jenkins"</span> <span class="attr">reloadable</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">              /Host&gt;</span><br></pre></td></tr></table></figure><p>根据提示粘贴密码验证</p><p>安装推荐的插件，大概率下载不下来，进去jenkins中，在<code>管理Jenkins-&gt;插件管理中选择高级选项卡</code>，升级站点输入，提交。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;jenkins&#x2F;updates&#x2F;update-center.json</span><br></pre></td></tr></table></figure><h1 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 2: 添加软件源信息</span></span><br><span class="line">sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 3: 更新并安装Docker-CE</span></span><br><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum -y install docker-ce</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 4: 开启Docker服务</span></span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 官方软件源默认启用了最新的软件，您可以通过编辑软件源的方式获取各个版本的软件包。例如官方并没有将测试版本的软件源置为可用，您可以通过以下方式开启。同理可以开启各种测试版本等。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> vim /etc/yum.repos.d/docker-ee.repo</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   将[docker-ce-test]下方的enabled=0修改为enabled=1</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装指定版本的Docker-CE:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 1: 查找Docker-CE的版本:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> yum list docker-ce.x86_64 --showduplicates | sort -r</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Loading mirror speeds from cached hostfile</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Loaded plugins: branch, fastestmirror, langpacks</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Available Packages</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Step2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.0.ce.1-1.el7.centos)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo yum -y install docker-ce-[VERSION]</span></span><br></pre></td></tr></table></figure><h2 id="docker常用命令"><a href="#docker常用命令" class="headerlink" title="docker常用命令"></a>docker常用命令</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看docker镜像</span></span><br><span class="line">docker images</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除镜像</span></span><br><span class="line">docker rmi xxx（容器名称或id）</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看docker容器</span></span><br><span class="line">docker ps -a</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除容器</span></span><br><span class="line">docker rm xxx（容器名称或id）</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志</span></span><br><span class="line">docker logs xxx（容器名称或id）</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入容器内部</span></span><br><span class="line">docker exec -it xxx（容器名称或id） /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从主机复制到容器</span></span><br><span class="line">docker cp host_path containerID:container_path</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从容器复制到主机</span></span><br><span class="line">docker cp containerID:container_path host_path</span><br></pre></td></tr></table></figure><h2 id="docker安装nginx"><a href="#docker安装nginx" class="headerlink" title="docker安装nginx"></a>docker安装nginx</h2><ol><li><p>拉取nginx镜像：</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull nginx</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建挂载目录</span></span><br><span class="line">mkdir -p /usr/project/nginx/html</span><br><span class="line">mkdir -p /usr/project/nginx/logs</span><br><span class="line">mkdir -p /usr/project/nginx/conf</span><br></pre></td></tr></table></figure></li><li><p>上传nginx配置文件到/usr/project/nginx/conf目录下</p></li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs&#x2F;error.log;</span><br><span class="line">#error_log  logs&#x2F;error.log  notice;</span><br><span class="line">#error_log  logs&#x2F;error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs&#x2F;nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application&#x2F;octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span><br><span class="line">    #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span><br><span class="line">    #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs&#x2F;access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs&#x2F;host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">            root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              &#x2F;404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page &#x2F;50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  &#x2F;50x.html;</span><br><span class="line">        location &#x3D; &#x2F;50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http:&#x2F;&#x2F;127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  &#x2F;scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#39;s document root</span><br><span class="line">        # concurs with nginx&#39;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ &#x2F;\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location &#x2F; &#123;</span><br><span class="line">    #        root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location &#x2F; &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>创建容器：</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run --name nginx -d -p 80:80  \</span><br><span class="line">-v /usr/project/nginx/conf/nginx.conf:/etc/nginx/nginx.conf  \</span><br><span class="line">-v /usr/project/nginx/html:/usr/share/nginx/html \</span><br><span class="line">-v /usr/project/nginx/logs:/var/log/nginx nginx</span><br></pre></td></tr></table></figure><h2 id="docker安装gitlab"><a href="#docker安装gitlab" class="headerlink" title="docker安装gitlab"></a>docker安装gitlab</h2><ol><li>拉取镜像</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure><ol start="2"><li>启动容器</li></ol><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> --hostname是配置宿主机的ip（克隆时的地址），否则ip为容器ID</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 6003端口为http端口，6002端口为ssh克隆端口</span></span><br><span class="line">docker run -d \</span><br><span class="line">	--hostname 255.255.255.255 \</span><br><span class="line">    -p 8443:443 -p 6003:80 -p 6002:22 \</span><br><span class="line">    --name gitlab \</span><br><span class="line">    -v /usr/project/gitlab/config:/etc/gitlab \</span><br><span class="line">    -v /usr/project/gitlab/logs:/var/log/gitlab \</span><br><span class="line">    -v /usr/project/gitlab/data:/var/opt/gitlab \</span><br><span class="line">    gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure><p>在生成的挂载目录gitlab/config下，找到gitlab.rb文件修改gitlab_rails[‘gitlab_shell_ssh_port’] = 6002。</p><p>这里遇到点问题，安装完成后，ssh克隆正常，但是http方式，url上却少了6003端口，为默认的80端口。</p><p>这里采取进入容器内部<code>/opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml</code>，修改其端口为6003，执行<code>gitlab-ctl restart</code>重启gitlab解决。相对比较麻烦！后续看有没有其他方便点的操作。</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>部署</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEA-docker远程部署及调试springboot</title>
    <url>/2020/07/17/56061/</url>
    <content><![CDATA[<!-- build time:Wed Aug 26 2020 15:41:04 GMT+0800 (GMT+08:00) --><h1 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h1><h2 id="配置docker的远程端口"><a href="#配置docker的远程端口" class="headerlink" title="配置docker的远程端口"></a>配置docker的远程端口</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 修改docker.service支持远程访问</span></span><br><span class="line">vim /usr/lib/systemd/system/docker.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span></span><br><span class="line">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:9527 -H unix:///var/run/docker.sock</span><br><span class="line"><span class="meta">#</span><span class="bash"> 通知docker服务做出的修改</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启docker</span></span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="IDEA连接远程服务器Docker"><a href="#IDEA连接远程服务器Docker" class="headerlink" title="IDEA连接远程服务器Docker"></a>IDEA连接远程服务器Docker</h2><p>idea，settings搜索docker,没有请先安装docker插件。</p><p><img src="/2020/07/17/56061/1.png" alt="1594951904"></p><p>显示docker images及container</p><p><img src="/2020/07/17/56061/2.png" alt="1594951904"></p><h2 id="远程部署服务"><a href="#远程部署服务" class="headerlink" title="远程部署服务"></a>远程部署服务</h2><p>在src/main下新建docker文件夹，新建Dockerfile文件</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> zyj &lt;<span class="number">1769072244</span>@qq.com&gt;</span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /tmp</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> railway-platform-1.0.0-release.jar app.jar</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> bash -c <span class="string">'touch /app.jar'</span></span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8085</span> <span class="number">11005</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"java"</span>,<span class="string">"-Djava.security.egd=file:/dev/./urandom"</span>,<span class="string">"-jar"</span>,<span class="string">"/app.jar"</span>]</span></span><br><span class="line"><span class="comment">#ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=11005","/app.jar"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> ln -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br></pre></td></tr></table></figure><p>maven打包，将jar包放置在src/main/docker文件夹内,配置dockerfile启动，Dockerfile选择新建的Dockerfile文件。</p><p><img src="/2020/07/17/56061/3.png" alt="1594951904"></p><p>最后运行docker，会构建镜像及启动容器。</p><h1 id="远程调试"><a href="#远程调试" class="headerlink" title="远程调试"></a>远程调试</h1><p><img src="/2020/07/17/56061/4.png" alt="1594951904"></p><p>添加Remote，host填写服务器ip，port填写监听端口，复制</p><p><code>-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=11005</code></p><p>到Dockerfile文件中</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> zyj &lt;<span class="number">1769072244</span>@qq.com&gt;</span><br><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /tmp</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> railway-platform-1.0.0-release.jar app.jar</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> bash -c <span class="string">'touch /app.jar'</span></span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8085</span> <span class="number">11005</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"java"</span>,<span class="string">"-Djava.security.egd=file:/dev/./urandom"</span>,<span class="string">"-jar"</span>,<span class="string">"-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=11005"</span>,<span class="string">"/app.jar"</span>]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> TZ=Asia/Shanghai</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> ln -snf /usr/share/zoneinfo/<span class="variable">$TZ</span> /etc/localtime &amp;&amp; <span class="built_in">echo</span> <span class="variable">$TZ</span> &gt; /etc/timezone</span></span><br></pre></td></tr></table></figure><p>点击下方+号，添加Dockerfile文件。debug启动，结束。</p><p><img src="/2020/07/17/56061/5.png" alt="1594951904"></p><h1 id="webstorm远程部署vue"><a href="#webstorm远程部署vue" class="headerlink" title="webstorm远程部署vue"></a>webstorm远程部署vue</h1><p>和idea操作基本一致，在根目录新建nginx.conf</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs&#x2F;error.log;</span><br><span class="line">#error_log  logs&#x2F;error.log  notice;</span><br><span class="line">#error_log  logs&#x2F;error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs&#x2F;nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application&#x2F;octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span><br><span class="line">    #                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span><br><span class="line">    #                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span><br><span class="line"></span><br><span class="line">    #access_log  logs&#x2F;access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs&#x2F;host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">            root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #error_page  404              &#x2F;404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page &#x2F;50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  &#x2F;50x.html;</span><br><span class="line">        location &#x3D; &#x2F;50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http:&#x2F;&#x2F;127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  &#x2F;scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache&#39;s document root</span><br><span class="line">        # concurs with nginx&#39;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ &#x2F;\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location &#x2F; &#123;</span><br><span class="line">    #        root   &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location &#x2F; &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx</span><br><span class="line"><span class="keyword">MAINTAINER</span> zyj &lt;<span class="number">1769072244</span>@qq.com&gt;</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> dist/  /usr/share/nginx/html/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> nginx.conf /etc/nginx/nginx.conf</span></span><br></pre></td></tr></table></figure><p>build打包，然后docker部署。</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>CI/CD</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
</search>
