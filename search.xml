<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>docker入门</title>
    <url>/2020/07/13/7842/</url>
    <content><![CDATA[<!-- build time:Fri Jul 17 2020 10:18:10 GMT+0800 (GMT+08:00) --><p>本次基于centos7.6操作</p><a id="more"></a><h1 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h1><p>打开阿里云官方镜像站<a href="https://developer.aliyun.com/mirror/，选择docker-ce,找到centos7。" target="_blank" rel="noopener">https://developer.aliyun.com/mirror/，选择docker-ce,找到centos7。</a></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> step 1: 安装必要的一些系统工具</span></span><br><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 2: 添加软件源信息</span></span><br><span class="line">sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 3: 更新并安装Docker-CE</span></span><br><span class="line">sudo yum makecache fast</span><br><span class="line">sudo yum -y install docker-ce</span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 4: 开启Docker服务</span></span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 官方软件源默认启用了最新的软件，您可以通过编辑软件源的方式获取各个版本的软件包。例如官方并没有将测试版本的软件源置为可用，您可以通过以下方式开启。同理可以开启各种测试版本等。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> vim /etc/yum.repos.d/docker-ee.repo</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   将[docker-ce-test]下方的enabled=0修改为enabled=1</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装指定版本的Docker-CE:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Step 1: 查找Docker-CE的版本:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> yum list docker-ce.x86_64 --showduplicates | sort -r</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Loading mirror speeds from cached hostfile</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Loaded plugins: branch, fastestmirror, langpacks</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable</span></span><br><span class="line"><span class="meta">#</span><span class="bash">   Available Packages</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Step2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.0.ce.1-1.el7.centos)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo yum -y install docker-ce-[VERSION]</span></span><br></pre></td></tr></table></figure><h1 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h1><ol><li><p>拉取官方镜像</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker pull mysql       # 拉取最新版mysql镜像</span><br></pre></td></tr></table></figure><p><a href="https://hub.docker.com/_/mysql/" target="_blank" rel="noopener">MySQL文档地址</a></p></li><li><p>检查是否拉取成功</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo docker images</span><br></pre></td></tr></table></figure></li><li><p>如果要建立目录映射</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run \</span><br><span class="line">    -p 3306:3306 \</span><br><span class="line">    -e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">    -v /usr/local/deploy/mysql/data:/var/lib/mysql:rw \</span><br><span class="line">    -v /usr/local/deploy/mysql/log:/var/log/mysql:rw \</span><br><span class="line">    -v /usr/local/deploy/mysql/config/my.cnf:/etc/mysql/my.cnf:rw \</span><br><span class="line">    -v /etc/localtime:/etc/localtime:ro \</span><br><span class="line">    --name mysql8 \</span><br><span class="line">    --restart=always \</span><br><span class="line">    -d mysql</span><br></pre></td></tr></table></figure><p>提前要在提定的位置（我的位置是：/usr/local/deploy）创建以下文件夹或文件：</p><ul><li>/usr/local/deploy 是数据库文件存放的地方。必须要挂载到容器外，否则容器重启一切数据消失。</li><li>mysql/log 是数据库主生的log。建议挂载到容器外。</li><li>mysql/config/my.cnf 是数据库的配置文件，在下面会放出来。</li><li>/etc/localtime:/etc/localtime:ro 是让容器的时钟与宿主机时钟同步，避免时区的问题，ro是read only的意思，就是只读。</li></ul></li><li><p>因为mysql8以上的的加密方式不一样 所以如果直接拿navicat连接的话会报错</p><p>输入 mysql -uroot -p 然后输入密码</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alter user &#39;root&#39;@&#39;%&#39; identified by &#39;root&#39; password expire never;</span><br><span class="line">alter user &#39;root&#39;@&#39;%&#39; identified with mysql_native_password by &#39;root&#39;;</span><br><span class="line">flush privileges;</span><br><span class="line">exit</span><br></pre></td></tr></table></figure><h1 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h1></li></ol><!-- rebuild by neat -->]]></content>
      <categories>
        <category>CI/CD</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
</search>
